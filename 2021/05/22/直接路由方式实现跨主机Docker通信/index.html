<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Jamza">





<title>直接路由方式实现跨主机 Docker 通信 | Jamza&#39;s Blog</title>



    <link rel="icon" href="/image/head.jpg">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.4.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Jamza&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Jamza&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">直接路由方式实现跨主机 Docker 通信</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Jamza</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">May 22, 2021&nbsp;&nbsp;12:15:06</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="直接路由方式实现跨主机-Docker-通信"><a href="#直接路由方式实现跨主机-Docker-通信" class="headerlink" title="直接路由方式实现跨主机 Docker 通信"></a>直接路由方式实现跨主机 Docker 通信</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>在两台宿主机分别创建自定义的 docker 网络，网络类型为 bridge，在各自的宿主机上创建 docker 容器，容器连接至各自主机上的自定义网络。在宿主机上创建路由规则，实现两台宿主机上的容器之间的互联通信。</p>
<p>通过宿主机上的网络命名空间 ID，向容器中添加多个网卡。</p>
<h2 id="网络地址划分"><a href="#网络地址划分" class="headerlink" title="网络地址划分"></a>网络地址划分</h2><h3 id="主控主机"><a href="#主控主机" class="headerlink" title="主控主机"></a>主控主机</h3><p>IP：192.168.83.83</p>
<p>网段：10.76.1.0/24</p>
<p>网关：10.76.1.1</p>
<p>自定义网络网桥名称：br01</p>
<p>容器 IP 地址：10.76.1.83、10.76.1.84、10.76.1.85</p>
<h3 id="线卡主机"><a href="#线卡主机" class="headerlink" title="线卡主机"></a>线卡主机</h3><p>IP：192.168.83.85</p>
<p>网段：10.76.2.0/24</p>
<p>网关：10.76.2.1</p>
<p>自定义网络网桥名称：br02</p>
<p>容器 IP 地址：10.76.2.83、10.76.2.84、10.76.2.85</p>
<h2 id="创建网络与容器"><a href="#创建网络与容器" class="headerlink" title="创建网络与容器"></a>创建网络与容器</h2><p>在主控主机上创建自定义网络的步骤流程如下：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta"># docker network ls</span></span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line"><span class="number">5</span>b591ed369ac        bridge              bridge              <span class="keyword">local</span></span><br><span class="line">b919f69968ec        docker_gwbridge     bridge              <span class="keyword">local</span></span><br><span class="line"><span class="number">032</span>c767b11de        host                host                <span class="keyword">local</span></span><br><span class="line">cad8d79e6d05        none                <span class="literal">null</span>                <span class="keyword">local</span></span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta">#</span></span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta"># docker network create --subnet=10.76.1.0/24 --gateway=10.76.1.1 -o <span class="string">&quot;com.docker.network.bridge.name&quot;</span>=br01 -o <span class="string">&quot;com.docker.network.bridge.enable_icc&quot;</span>=true net1</span></span><br><span class="line"><span class="number">52318642206e51</span>c48599d06f2d8a4473e23aa485084cc9ca48618cdfc6b867fd</span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta">#</span></span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta"># docker network ls</span></span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line"><span class="number">5</span>b591ed369ac        bridge              bridge              <span class="keyword">local</span></span><br><span class="line">b919f69968ec        docker_gwbridge     bridge              <span class="keyword">local</span></span><br><span class="line"><span class="number">032</span>c767b11de        host                host                <span class="keyword">local</span></span><br><span class="line"><span class="number">52318642206</span>e        net1                bridge              <span class="keyword">local</span></span><br><span class="line">cad8d79e6d05        none                <span class="literal">null</span>                <span class="keyword">local</span></span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta">#</span></span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta"># docker network inspect net1</span></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;net1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Id&quot;</span>: <span class="string">&quot;52318642206e51c48599d06f2d8a4473e23aa485084cc9ca48618cdfc6b867fd&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Created&quot;</span>: <span class="string">&quot;2019-08-06T14:18:03.256967046+08:00&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Scope&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;bridge&quot;</span>,</span><br><span class="line">        <span class="string">&quot;EnableIPv6&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;IPAM&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Options&quot;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&quot;Config&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;Subnet&quot;</span>: <span class="string">&quot;10.76.1.0/24&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Gateway&quot;</span>: <span class="string">&quot;10.76.1.1&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Internal&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Attachable&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Containers&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;Options&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;com.docker.network.bridge.enable_icc&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">            <span class="string">&quot;com.docker.network.bridge.name&quot;</span>: <span class="string">&quot;br01&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Labels&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta">#</span></span><br></pre></td></tr></table></figure>

<p>在主控主机上创建静态路由，表示访问 10.76.2.0/24 网段需经过 192.168.83.85 网卡（线卡主机），且经过本机 eth0 网卡。</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span># ip route</span><br><span class="line">default via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">1</span> dev eth0</span><br><span class="line"><span class="number">10.76.1.0</span>/<span class="number">24</span> dev br01 proto kernel scope link src <span class="number">10</span>.<span class="number">76</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth0 scope link metric <span class="number">1002</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth20 scope link metric <span class="number">1003</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth21 scope link metric <span class="number">1004</span></span><br><span class="line"><span class="number">172.17.6.0</span>/<span class="number">24</span> dev docker0 proto kernel scope link src <span class="number">172</span>.<span class="number">17</span>.<span class="number">6</span>.<span class="number">252</span></span><br><span class="line"><span class="number">172.18.0.0</span>/<span class="number">20</span> dev docker_gwbridge proto kernel scope link src <span class="number">172</span>.<span class="number">18</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="number">192.168.83.0</span>/<span class="number">24</span> dev eth0 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">83</span></span><br><span class="line"><span class="number">192.168.84.0</span>/<span class="number">24</span> dev eth20 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">84</span>.<span class="number">83</span></span><br><span class="line"><span class="number">192.168.85.0</span>/<span class="number">24</span> dev eth21 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">85</span>.<span class="number">83</span></span><br><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span># ip route add <span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">0</span>/<span class="number">24</span> via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">85</span> dev eth0</span><br><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span># ip route</span><br><span class="line">default via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">1</span> dev eth0</span><br><span class="line"><span class="number">10.76.1.0</span>/<span class="number">24</span> dev br01 proto kernel scope link src <span class="number">10</span>.<span class="number">76</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="number">10.76.2.0</span>/<span class="number">24</span> via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">85</span> dev eth0</span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth0 scope link metric <span class="number">1002</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth20 scope link metric <span class="number">1003</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth21 scope link metric <span class="number">1004</span></span><br><span class="line"><span class="number">172.17.6.0</span>/<span class="number">24</span> dev docker0 proto kernel scope link src <span class="number">172</span>.<span class="number">17</span>.<span class="number">6</span>.<span class="number">252</span></span><br><span class="line"><span class="number">172.18.0.0</span>/<span class="number">20</span> dev docker_gwbridge proto kernel scope link src <span class="number">172</span>.<span class="number">18</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="number">192.168.83.0</span>/<span class="number">24</span> dev eth0 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">83</span></span><br><span class="line"><span class="number">192.168.84.0</span>/<span class="number">24</span> dev eth20 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">84</span>.<span class="number">83</span></span><br><span class="line"><span class="number">192.168.85.0</span>/<span class="number">24</span> dev eth21 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">85</span>.<span class="number">83</span></span><br><span class="line"><span class="string">[root@jamza_vm_master_litepaas route_net_test]</span>#</span><br></pre></td></tr></table></figure>

<p>在主控主机上创建容器，并启动容器：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]# docker run -it --privileged=true --net net1 --name test --ip <span class="number">10.76</span>.<span class="number">1.83</span> -v /lib64:/lib64 -v /usr/sbin/tcpdump:/bin/tcpdump busybox/x86_64 /bin/<span class="keyword">sh</span></span><br><span class="line">/ #</span><br><span class="line">/ # ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr <span class="number">02</span>:<span class="number">42</span>:<span class="number">0</span>A:<span class="number">4</span>C:<span class="number">01</span>:<span class="number">53</span></span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">1.83</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">42</span>:aff:fe4c:<span class="number">153</span>/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:14</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:7</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">0</span></span><br><span class="line">          RX byte<span class="variable">s:1156</span> (<span class="number">1.1</span> KiB)  TX byte<span class="variable">s:578</span> (<span class="number">578.0</span> B)</span><br><span class="line"></span><br><span class="line"><span class="keyword">lo</span>        Link encap:Local Loopback</span><br><span class="line">          inet addr:<span class="number">127.0</span>.<span class="number">0.1</span>  Mask:<span class="number">255.0</span>.<span class="number">0.0</span></span><br><span class="line">          inet6 addr: ::<span class="number">1</span>/<span class="number">128</span> Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:<span class="number">65536</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:0</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:0</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1</span></span><br><span class="line">          RX byte<span class="variable">s:0</span> (<span class="number">0.0</span> B)  TX byte<span class="variable">s:0</span> (<span class="number">0.0</span> B)</span><br><span class="line"></span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>

<p>同理，在线卡主机上创建自定义网络，添加路由规则，并启动容器，连接到自定义网络：</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span># docker network create --subnet=<span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">0</span>/<span class="number">24</span> --gateway=<span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">1</span> -o <span class="string">&quot;com.docker.network.bridge.name&quot;</span>=br02 -o <span class="string">&quot;com.docker.network.bridge.enable_icc&quot;</span>=true net1</span><br><span class="line">0879d05f096683aba90b013620fc6e3e0ebd2b5d5896fc3a6fc3a575846e4666</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span># docker network ls</span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">055d9dddcab8        bridge              bridge              local</span><br><span class="line">bd5b745fb87f        docker_gwbridge     bridge              local</span><br><span class="line">a20b3d67c74d        host                host                local</span><br><span class="line">0879d05f0966        net1                bridge              local</span><br><span class="line">d8bdffcb4f6e        none                null                local</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span># ip route</span><br><span class="line">default via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">1</span> dev eth0</span><br><span class="line"><span class="number">10.76.2.0</span>/<span class="number">24</span> dev br02 proto kernel scope link src <span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">1</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth0 scope link metric <span class="number">1002</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth20 scope link metric <span class="number">1003</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth21 scope link metric <span class="number">1004</span></span><br><span class="line"><span class="number">172.17.9.0</span>/<span class="number">24</span> dev docker0 proto kernel scope link src <span class="number">172</span>.<span class="number">17</span>.<span class="number">9</span>.<span class="number">252</span></span><br><span class="line"><span class="number">172.18.0.0</span>/<span class="number">20</span> dev docker_gwbridge proto kernel scope link src <span class="number">172</span>.<span class="number">18</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="number">192.168.83.0</span>/<span class="number">24</span> dev eth0 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">85</span></span><br><span class="line"><span class="number">192.168.84.0</span>/<span class="number">24</span> dev eth20 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">84</span>.<span class="number">85</span></span><br><span class="line"><span class="number">192.168.85.0</span>/<span class="number">24</span> dev eth21 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">85</span>.<span class="number">85</span></span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span># ip route add <span class="number">10</span>.<span class="number">76</span>.<span class="number">1</span>.<span class="number">0</span>/<span class="number">24</span> via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">83</span> dev eth0</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span># ip route</span><br><span class="line">default via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">1</span> dev eth0</span><br><span class="line"><span class="number">10.76.1.0</span>/<span class="number">24</span> via <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">83</span> dev eth0</span><br><span class="line"><span class="number">10.76.2.0</span>/<span class="number">24</span> dev br02 proto kernel scope link src <span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">1</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth0 scope link metric <span class="number">1002</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth20 scope link metric <span class="number">1003</span></span><br><span class="line"><span class="number">169.254.0.0</span>/<span class="number">16</span> dev eth21 scope link metric <span class="number">1004</span></span><br><span class="line"><span class="number">172.17.9.0</span>/<span class="number">24</span> dev docker0 proto kernel scope link src <span class="number">172</span>.<span class="number">17</span>.<span class="number">9</span>.<span class="number">252</span></span><br><span class="line"><span class="number">172.18.0.0</span>/<span class="number">20</span> dev docker_gwbridge proto kernel scope link src <span class="number">172</span>.<span class="number">18</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="number">192.168.83.0</span>/<span class="number">24</span> dev eth0 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">83</span>.<span class="number">85</span></span><br><span class="line"><span class="number">192.168.84.0</span>/<span class="number">24</span> dev eth20 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">84</span>.<span class="number">85</span></span><br><span class="line"><span class="number">192.168.85.0</span>/<span class="number">24</span> dev eth21 proto kernel scope link src <span class="number">192</span>.<span class="number">168</span>.<span class="number">85</span>.<span class="number">85</span></span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span>#</span><br><span class="line"><span class="string">[root@jamza_vm_lp0_litepaas route_net_test]</span># docker run -it --privileged=true --net net1 --name test --ip <span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">83</span> -v /lib64:/lib64 -v /usr/sbin/tcpdump:/bin/tcpdump busybox/x86_64 /bin/sh</span><br><span class="line">/ #</span><br><span class="line">/ # ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr <span class="number">02</span>:<span class="number">42</span>:0A:4C:<span class="number">02</span>:<span class="number">53</span></span><br><span class="line">          inet addr:<span class="number">10</span>.<span class="number">76</span>.<span class="number">2</span>.<span class="number">83</span>  Bcast:<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>  Mask:<span class="number">255</span>.<span class="number">255</span>.<span class="number">255</span>.<span class="number">0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">42</span>:aff:fe4c:<span class="number">253</span>/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packets:<span class="number">12</span> errors:<span class="number">0</span> dropped:<span class="number">0</span> overruns:<span class="number">0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packets:<span class="number">6</span> errors:<span class="number">0</span> dropped:<span class="number">0</span> overruns:<span class="number">0</span> carrier:<span class="number">0</span></span><br><span class="line">          collisions:<span class="number">0</span> txqueuelen:<span class="number">0</span></span><br><span class="line">          RX bytes:<span class="number">1016</span> (<span class="number">1016</span>.<span class="number">0</span> B)  TX bytes:<span class="number">508</span> (<span class="number">508</span>.<span class="number">0</span> B)</span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback</span><br><span class="line">          inet addr:<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>  Mask:<span class="number">255</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">          inet6 addr: ::<span class="number">1</span>/<span class="number">128</span> Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:<span class="number">65536</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packets:<span class="number">0</span> errors:<span class="number">0</span> dropped:<span class="number">0</span> overruns:<span class="number">0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packets:<span class="number">0</span> errors:<span class="number">0</span> dropped:<span class="number">0</span> overruns:<span class="number">0</span> carrier:<span class="number">0</span></span><br><span class="line">          collisions:<span class="number">0</span> txqueuelen:<span class="number">1</span></span><br><span class="line">          RX bytes:<span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)  TX bytes:<span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line"></span><br><span class="line">/ #</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>

<p>此时两个容器能够互相 ping 通：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#主控上容器ping线卡上容器</span></span><br><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.2.83<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.2.83 (10.76.2.83): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.359 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.485 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.479 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.559 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=4 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.505 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=5 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.510 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.2.83<span class="built_in"> ping </span>statistics ---</span><br><span class="line">6 packets transmitted, 6 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.359/0.482/0.559 ms</span><br><span class="line">/ #</span><br><span class="line">/ #</span><br><span class="line"></span><br><span class="line"><span class="comment">#线卡上容器ping主控上容器</span></span><br><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.1.83<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.1.83 (10.76.1.83): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.348 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.401 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.429 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.574 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=4 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.519 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=5 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.584 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.1.83<span class="built_in"> ping </span>statistics ---</span><br><span class="line">6 packets transmitted, 6 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.348/0.475/0.584 ms</span><br><span class="line">/ #</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>

<h2 id="向容器中添加网卡"><a href="#向容器中添加网卡" class="headerlink" title="向容器中添加网卡"></a>向容器中添加网卡</h2><p>向容器中添加网卡，需使用两个虚拟的以太网端口，即 veth pair。容器中的网络命名空间与宿主机的网络命名空间是隔离的，需将 veth pair 的一端添加到容器的网络命名空间中，将另一端添加到宿主机的网络命名空间，即实现两个网络命名空间通过 veth pair 通信。</p>
<p>对主控主机中的容器添加虚拟网卡，首先是获取容器所在的网络命名空间 ID，其中 test 是已经启动的 docker 容器的名称，获取的 ID 为 10281：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta"># docker inspect -f <span class="string">&#x27;&#123;&#123;.State.Pid&#125;&#125;&#x27;</span> test</span></span><br><span class="line"><span class="number">10281</span></span><br><span class="line">[root<span class="symbol">@jamza_vm_master_litepaas</span> route_net_test]<span class="meta">#</span></span><br></pre></td></tr></table></figure>

<p>后续将使用 ip netns 命令，而命令的有效目录是/var/run/netns/，因此需通过软链接的方式创建/var/run/netns/目录下的容器网络命名空间：</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@jamza_vm_master_litepaas route_net_test]# ll <span class="regexp">/var/</span>run<span class="regexp">/netns/</span></span><br><span class="line">总用量 <span class="number">0</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]# ln -s <span class="regexp">/proc/</span><span class="number">10281</span><span class="regexp">/ns/</span>net <span class="regexp">/var/</span>run<span class="regexp">/netns/</span><span class="number">10281</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]# ll <span class="regexp">/var/</span>run<span class="regexp">/netns/</span></span><br><span class="line">总用量 <span class="number">0</span></span><br><span class="line">lrwxrwxrwx. <span class="number">1</span> root root <span class="number">18</span> <span class="number">8</span>月   <span class="number">6</span> <span class="number">14</span>:<span class="number">49</span> <span class="number">10281</span> -&gt; <span class="regexp">/proc/</span><span class="number">10281</span><span class="regexp">/ns/</span>net</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]# ip netns</span><br><span class="line"><span class="number">10281</span> (id: <span class="number">0</span>)</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br></pre></td></tr></table></figure>

<p>创建两对 veth pair，其中 veth0 与 veth1 为一对，veth2 与 veth3 为一对：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>link <span class="builtin-name">add</span> veth0<span class="built_in"> type </span>veth<span class="built_in"> peer </span>name veth1</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>link <span class="builtin-name">add</span> veth2<span class="built_in"> type </span>veth<span class="built_in"> peer </span>name veth3</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br></pre></td></tr></table></figure>

<p>将 veth pair 中的 veth1 与 veth3 与宿主机上的自定义 docker 网络的网关 br01 相关联，并启动 veth1 与 veth3 端口：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment"># ip link set dev veth1 master br01</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment"># ip link set dev veth1 up</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment">#</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment"># ip link set dev veth3 master br01</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment"># ip link set dev veth3 up</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment">#</span></span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]<span class="comment"># ip addr</span></span><br><span class="line">......(略)</span><br><span class="line"><span class="number">68</span>: br01: <span class="variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="number">1500</span> qdisc noqueue <span class="keyword">state</span> UP</span><br><span class="line">    link/ether <span class="number">02</span>:<span class="number">42</span>:bd:a4:a2:de brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    <span class="keyword">inet</span> <span class="number">10.76</span>.<span class="number">1.1</span>/<span class="number">24</span> scope <span class="keyword">global</span> br01</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    <span class="keyword">inet6</span> fe80::<span class="number">42</span>:bdff:fea4:a2de/<span class="number">64</span> scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="number">70</span>: vethdea75f3@if69: <span class="variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="number">1500</span> qdisc noqueue master br01 <span class="keyword">state</span> UP</span><br><span class="line">    link/ether de:fb:<span class="number">93</span>:<span class="number">07</span>:f5:<span class="number">6</span>e brd ff:ff:ff:ff:ff:ff link-netnsid <span class="number">0</span></span><br><span class="line">    <span class="keyword">inet6</span> fe80::dcfb:<span class="number">93</span>ff:fe07:f56e/<span class="number">64</span> scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="number">71</span>: veth1@veth0: <span class="variable">&lt;NO-CARRIER,BROADCAST,MULTICAST,UP,M-DOWN&gt;</span> mtu <span class="number">1500</span> qdisc noqueue master br01 <span class="keyword">state</span> LOWERLAYERDOWN qlen <span class="number">1000</span></span><br><span class="line">    link/ether <span class="number">9</span>e:<span class="number">0</span>e:<span class="number">4</span>d:<span class="number">74</span>:c6:<span class="number">9</span>c brd ff:ff:ff:ff:ff:ff</span><br><span class="line"><span class="number">72</span>: veth0@veth1: <span class="variable">&lt;BROADCAST,MULTICAST&gt;</span> mtu <span class="number">1500</span> qdisc noop <span class="keyword">state</span> DOWN qlen <span class="number">1000</span></span><br><span class="line">    link/ether <span class="number">62</span>:<span class="number">3</span>c:be:c3:<span class="number">73</span>:d2 brd ff:ff:ff:ff:ff:ff</span><br><span class="line"><span class="number">73</span>: veth3@veth2: <span class="variable">&lt;NO-CARRIER,BROADCAST,MULTICAST,UP,M-DOWN&gt;</span> mtu <span class="number">1500</span> qdisc noqueue master br01 <span class="keyword">state</span> LOWERLAYERDOWN qlen <span class="number">1000</span></span><br><span class="line">    link/ether <span class="number">4</span>e:<span class="number">15</span>:bc:<span class="number">96</span>:<span class="number">5</span>a:<span class="number">12</span> brd ff:ff:ff:ff:ff:ff</span><br><span class="line"><span class="number">74</span>: veth2@veth3: <span class="variable">&lt;BROADCAST,MULTICAST&gt;</span> mtu <span class="number">1500</span> qdisc noop <span class="keyword">state</span> DOWN qlen <span class="number">1000</span></span><br><span class="line">    link/ether <span class="number">6</span>e:a7:<span class="number">45</span>:<span class="number">2</span>c:b5:<span class="number">0</span>e brd ff:ff:ff:ff:ff:ff</span><br></pre></td></tr></table></figure>

<p>然后配置 veth pair 中的 veth0 与 veth2 在容器中启动：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>link <span class="builtin-name">set</span> dev veth0 name eth1 netns 10281</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>netns exec 10281<span class="built_in"> ip </span>link <span class="builtin-name">set</span> dev eth1 up</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>netns exec 10281<span class="built_in"> ip </span>addr <span class="builtin-name">add</span> 10.76.1.84/24 dev eth1</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>link <span class="builtin-name">set</span> dev veth2 name eth2 netns 10281</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>netns exec 10281<span class="built_in"> ip </span>link <span class="builtin-name">set</span> dev eth2 up</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#<span class="built_in"> ip </span>netns exec 10281<span class="built_in"> ip </span>addr <span class="builtin-name">add</span> 10.76.1.85/24 dev eth2</span><br><span class="line">[root@jamza_vm_master_litepaas route_net_test]#</span><br></pre></td></tr></table></figure>

<p>然后再主控主机的容器中，可以看到新添加的虚拟网卡：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/ #</span><br><span class="line">/ # ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr <span class="number">02</span>:<span class="number">42</span>:<span class="number">0</span>A:<span class="number">4</span>C:<span class="number">01</span>:<span class="number">53</span></span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">1.83</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">42</span>:aff:fe4c:<span class="number">153</span>/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:47</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:23</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">0</span></span><br><span class="line">          RX byte<span class="variable">s:3894</span> (<span class="number">3.8</span> KiB)  TX byte<span class="variable">s:1950</span> (<span class="number">1.9</span> KiB)</span><br><span class="line"></span><br><span class="line">eth1      Link encap:Ethernet  HWaddr <span class="number">62</span>:<span class="number">3</span>C:BE:C3:<span class="number">73</span>:D2</span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">1.84</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">603</span><span class="keyword">c</span>:beff:fec3:<span class="number">73</span>d2/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:16</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:8</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1000</span></span><br><span class="line">          RX byte<span class="variable">s:1296</span> (<span class="number">1.2</span> KiB)  TX byte<span class="variable">s:648</span> (<span class="number">648.0</span> B)</span><br><span class="line"></span><br><span class="line">eth2      Link encap:Ethernet  HWaddr <span class="number">6</span>E:A7:<span class="number">45</span>:<span class="number">2</span>C:B5:<span class="number">0</span>E</span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">1.85</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">6</span>ca7:<span class="number">45</span>ff:fe2c:b50e/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:8</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:8</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1000</span></span><br><span class="line">          RX byte<span class="variable">s:648</span> (<span class="number">648.0</span> B)  TX byte<span class="variable">s:648</span> (<span class="number">648.0</span> B)</span><br><span class="line"></span><br><span class="line"><span class="keyword">lo</span>        Link encap:Local Loopback</span><br><span class="line">          inet addr:<span class="number">127.0</span>.<span class="number">0.1</span>  Mask:<span class="number">255.0</span>.<span class="number">0.0</span></span><br><span class="line">          inet6 addr: ::<span class="number">1</span>/<span class="number">128</span> Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:<span class="number">65536</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:0</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:0</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1</span></span><br><span class="line">          RX byte<span class="variable">s:0</span> (<span class="number">0.0</span> B)  TX byte<span class="variable">s:0</span> (<span class="number">0.0</span> B)</span><br><span class="line"></span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>

<p>同理，在线卡主机上向容器中添加网卡，结果如下：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/ # ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr <span class="number">02</span>:<span class="number">42</span>:<span class="number">0</span>A:<span class="number">4</span>C:<span class="number">02</span>:<span class="number">53</span></span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">2.83</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">42</span>:aff:fe4c:<span class="number">253</span>/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:28</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:8</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">0</span></span><br><span class="line">          RX byte<span class="variable">s:2312</span> (<span class="number">2.2</span> KiB)  TX byte<span class="variable">s:648</span> (<span class="number">648.0</span> B)</span><br><span class="line"></span><br><span class="line">eth1      Link encap:Ethernet  HWaddr F6:<span class="number">6</span>C:<span class="number">37</span>:<span class="number">75</span>:A9:D4</span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">2.84</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::f46c:<span class="number">37</span>ff:fe75:a9d4/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:12</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:6</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1000</span></span><br><span class="line">          RX byte<span class="variable">s:1016</span> (<span class="number">1016.0</span> B)  TX byte<span class="variable">s:508</span> (<span class="number">508.0</span> B)</span><br><span class="line"></span><br><span class="line">eth2      Link encap:Ethernet  HWaddr <span class="number">76</span>:<span class="number">64</span>:D9:<span class="number">37</span>:<span class="number">6</span>B:<span class="number">98</span></span><br><span class="line">          inet addr:<span class="number">10.76</span>.<span class="number">2.85</span>  Bcas<span class="variable">t:0</span>.<span class="number">0.0</span>.<span class="number">0</span>  Mask:<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">          inet6 addr: fe80::<span class="number">7464</span>:d9ff:fe37:<span class="number">6</span>b98/<span class="number">64</span> Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:11</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:6</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1000</span></span><br><span class="line">          RX byte<span class="variable">s:926</span> (<span class="number">926.0</span> B)  TX byte<span class="variable">s:508</span> (<span class="number">508.0</span> B)</span><br><span class="line"></span><br><span class="line"><span class="keyword">lo</span>        Link encap:Local Loopback</span><br><span class="line">          inet addr:<span class="number">127.0</span>.<span class="number">0.1</span>  Mask:<span class="number">255.0</span>.<span class="number">0.0</span></span><br><span class="line">          inet6 addr: ::<span class="number">1</span>/<span class="number">128</span> Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:<span class="number">65536</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:0</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:0</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1</span></span><br><span class="line">          RX byte<span class="variable">s:0</span> (<span class="number">0.0</span> B)  TX byte<span class="variable">s:0</span> (<span class="number">0.0</span> B)</span><br><span class="line"></span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>

<p>测试两个主机上的容器之间是否能够 ping 通。在主控主机上的容器中测试：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.2.83<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.2.83 (10.76.2.83): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.436 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.560 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.519 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.516 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.83: <span class="attribute">seq</span>=4 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.443 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.2.83<span class="built_in"> ping </span>statistics ---</span><br><span class="line">5 packets transmitted, 5 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.436/0.494/0.560 ms</span><br><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.2.84<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.2.84 (10.76.2.84): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.84: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.355 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.84: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.537 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.84: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.540 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.84: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.435 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.2.84<span class="built_in"> ping </span>statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.355/0.466/0.540 ms</span><br><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.2.85<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.2.85 (10.76.2.85): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.85: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.394 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.85: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.334 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.85: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.438 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.2.85: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.321 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.2.85<span class="built_in"> ping </span>statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.321/0.371/0.438 ms</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>

<p>在线卡主机的容器中测试，结果显示，各个网络地址互相之间能够 ping 通：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.1.83<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.1.83 (10.76.1.83): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.332 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.584 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.524 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.83: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.541 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.1.83<span class="built_in"> ping </span>statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.332/0.495/0.584 ms</span><br><span class="line">/ #</span><br><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.1.84<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.1.84 (10.76.1.84): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.84: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.355 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.84: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.563 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.84: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.559 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.84: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.422 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.1.84<span class="built_in"> ping </span>statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.355/0.474/0.563 ms</span><br><span class="line">/ #</span><br><span class="line">/ #</span><br><span class="line">/ #<span class="built_in"> ping </span>10.76.1.85<span class="built_in"></span></span><br><span class="line"><span class="built_in">PING </span>10.76.1.85 (10.76.1.85): 56 data bytes</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.85: <span class="attribute">seq</span>=0 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.354 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.85: <span class="attribute">seq</span>=1 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.413 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.85: <span class="attribute">seq</span>=2 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.520 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 10.76.1.85: <span class="attribute">seq</span>=3 <span class="attribute">ttl</span>=62 <span class="attribute">time</span>=0.561 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.76.1.85<span class="built_in"> ping </span>statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.354/0.462/0.561 ms</span><br><span class="line">/ #</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>
        </div>

        
            <section class="post-copyright">
                
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/docker/"># docker</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/05/22/macvlan%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%E8%B7%A8%E4%B8%BB%E6%9C%BADocker%E9%80%9A%E4%BF%A1/">macvlan 网络模式实现跨主机 Docker 通信</a>
            
            
            <a class="next" rel="next" href="/2021/05/22/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C%E5%AE%9E%E7%8E%B0%E8%B7%A8%E4%B8%BB%E6%9C%BADocker%E9%80%9A%E4%BF%A1/">自定义网络实现跨主机 Docker 通信</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Jamza | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
